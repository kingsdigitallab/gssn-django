{% load cms_tags wagtailcore_tags %}

{% if 'events' not in self.url %}
<h3>Membership</h3>
<hr>
<a href="#" class="button">Join</a>
{% endif %}

{% if 'about' in self.url %}
<h3>Research</h3>
<hr>

{% get_resources_index_page as rip %}
<ul>
	<li><a href="{% pageurl rip %}">{{ rip.title }}</a></li>
	{% for page in rip.get_children %}
	<li><a href="{% pageurl page %}">{{ page.title }}</a></li>
	{% endfor %}
</ul>

<h3>Events</h3>
<hr>

{% get_event_index_page as eip %}
<ul>
	{% for event in eip.live_events|slice:":3" %}
    <li>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	{% for event in eip.past_events|slice:":3" %}
    <li>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	<li>Sorry, no events planned.</li>
	{% endfor %}
	{% endfor %}
</ul>

<h3>News</h3>
<hr>

{% get_blog_index_page as bip %}
<ul>
	{% for post in bip.posts|slice:":3" %}
	<li>
		<a href="{% pageurl post %}">{{ post.title }}</a>
	</li>
	{% empty %}
	<li>Sorry, nothing to show here.</li>
	{% endfor %}
</ul>

{% elif 'research' in self.url %}



<h3>Events</h3>
<hr>

{% get_event_index_page as eip %}
<ul>
	{% for event in eip.live_events|slice:":3" %}
    <li>
        <time datetime="{{ event.date_from|date:'c' }}" class="calendar-icon">{{ event.date_from|date_as_block }}</time>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	{% for event in eip.past_events|slice:":3" %}
    <li>
        <time datetime="{{ event.date_from|date:'c' }}" class="calendar-icon">{{ event.date_from|date_as_block }}</time>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	<li>Sorry, no events planned.</li>
	{% endfor %}
	{% endfor %}
</ul>

{% elif 'events' in self.url %}
<h3>Next event</h3>
<hr>
<a href="#" class="button">Join</a>

<h3>What's on</h3>
<hr>

{% get_event_index_page as eip %}
<ul>
	{% for event in eip.live_events|slice:":3" %}
    <li>
        <time datetime="{{ event.date_from|date:'c' }}" class="calendar-icon">{{ event.date_from|date_as_block }}</time>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	{% for event in eip.past_events|slice:":3" %}
    <li>
        <time datetime="{{ event.date_from|date:'c' }}" class="calendar-icon">{{ event.date_from|date_as_block }}</time>
        <a href="{% pageurl event %}">{{ event.title }}</a>
    </li>
	{% empty %}
	<li>Sorry, no events planned.</li>
	{% endfor %}
	{% endfor %}
</ul>
{% endif %}